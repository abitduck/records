---
layout: post
title: 字节对齐与结构体大小
tags:
- cplusplus
categories: cplusplus
description: 字节对齐与结构体大小
---

结构体的sizeof值,并不是简单的将其中各元素所占字节相加，而是要考虑到存储空间的字节对齐问题。本文讲述一下C++中结构体大小的求法。 实验操作系统环境为64bit Centos7.3：

<!-- more -->
<pre>
# uname -a
Linux compile 3.10.0-514.el7.x86_64 #1 SMP Tue Nov 22 16:42:41 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux

# cat /etc/centos-release
CentOS Linux release 7.3.1611 (Core) 
</pre>


## 1. 解释
现代计算机中内存空间都是按照byte划分的，从理论上讲似乎对任何类型的变量的访问可以从任何地址开始， 但实际情况是在访问特定类型变量的时候经常在特定的内存地址访问， 这就需要各种类型数据按照一定的规则在空间上排列， 而不是顺序的一个接一个的排放，这就是对齐。

各个硬件平台对存储空间的处理上有很大的不同。一些平台对某些特定类型的数据只能从某些特定的地址开始存取。比如有些架构的CPU在访问一个没有进行对齐的变量的时候会发生错误， 那么在这种架构下编程必须保证字节对齐。其他平台可能没有这种情况，但是最常见的是如果不按照适合其平台要求对数据存放进行对齐， 会在存取效率上带来损失。 比如有些平台每次读都是从偶地址开始， 如果一个int型数据存放在```4字节对齐```的位置， 那么一个读周期就可以读出这32bit； 而如果存放的位置不是```4字节对齐```，则很有可能需要多个读周期才能将这32bit数据读取出来（可能需要进行高低字节拼凑)。






<br />
<br />

**[参考]**

1. [内存对齐与补齐 字节对齐与结构体大小](https://blog.csdn.net/u010479322/article/details/51137907)

<br />
<br />
<br />





