---
layout: post
title: Linux系统监测工具
tags:
- LinuxOps
categories: linuxOps
description: Linux系统监测工具
---


Linux提供了很多有用的工具，以方便开发人员调试和测评服务器程序。下面我们主要会介绍nc、strace、lsof、netstat、vmstat、ifstat和mpstat这些工具，它们通常都支持很多中选项，不过我们的讨论仅限于最常用、最实用的那些。

<!-- more -->



## 1. ifstat命令
ifstat是interface statistics的缩写，它是一个简单的网络流量监测工具。常用的选项和参数包括：

* -a: 监测系统上的所有网卡接口

* -i: 指定要监测的网卡接口

* -t: 在每行输出信息前加上时间戳

* -b： 以```Kbit/s```为单位显示数据，而不是默认的```	KB/s```

* delay: 采样间隔（单位是: 秒)，即每隔delay的时间输出一次统计信息

* count： 采样次数，即共输出count次统计信息



参看如下示例（注： 实际使用时可能由于ifstat版本不一致，导致有些选项不能正常使用）：
<pre>
# ifstat -a 
#32051.1804289383 sampling_interval=2 time_const=60
Interface        RX Pkts/Rate    TX Pkts/Rate    RX Data/Rate    TX Data/Rate  
                 RX Errs/Drop    TX Errs/Drop    RX Over/Rate    TX Coll/Rate  
lo                 3693M 702       3693M 702       1688M 313K      1688M 313K   
                       0 0             0 0             0 0             0 0      
eth1                   0 0             0 0             0 0             0 0      
                       0 0             0 0             0 0             0 0      
eth2             839555K 865       1078M 844       1272M 431K    491797K 416K   
                       0 11120K        0 0             0 0             0 0      
eth3               1121M 1K        1008M 1K      899871K 442K    399558K 455K   
                       0 11120K        0 0             0 0             0 0      
</pre>


## 2. iftop命令
iftop是一款实时流量监测工具，监控TCP/IP连接等，缺点是无报表功能。必须以root身份才能运行。下面简单介绍一下该工具的使用：
<pre>
# iftop -h
iftop: display bandwidth usage on an interface by host

Synopsis: iftop -h | [-npblNBP] [-i interface] [-f filter code]
                               [-F net/mask] [-G net6/mask6]

   -h                  display this message
   -n                  don't do hostname lookups
   -N                  don't convert port numbers to services
   -p                  run in promiscuous mode (show traffic between other
                       hosts on the same network segment)
   -b                  don't display a bar graph of traffic
   -B                  Display bandwidth in bytes
   -i interface        listen on named interface
   -f filter code      use filter code to select packets to count
                       (default: none, but only IP packets are counted)
   -F net/mask         show traffic flows in/out of IPv4 network
   -G net6/mask6       show traffic flows in/out of IPv6 network
   -l                  display and count link-local IPv6 traffic (default: off)
   -P                  show ports as well as hosts
   -m limit            sets the upper limit for the bandwidth scale
   -c config file      specifies an alternative configuration file
   -t                  use text interface without ncurses

   Sorting orders:
   -o 2s                Sort by first column (2s traffic average)
   -o 10s               Sort by second column (10s traffic average) [default]
   -o 40s               Sort by third column (40s traffic average)
   -o source            Sort by source address
   -o destination       Sort by destination address

   The following options are only available in combination with -t
   -s num              print one single text output afer num seconds, then quit
   -L num              number of lines to print

iftop, version 1.0pre4
copyright (c) 2002 Paul Warren <pdw@ex-parrot.com> and contributors
</pre>
下面简要介绍一下几个```选项```的含义：

* -n: 直接显示IP，不进行DNS反解析

* -N: 直接显示端口号，并不解析为服务名称

* -F： 可以用于显示某个网段进出封包流量
<pre>
# iftop -F 192.168.1.0/24 
# iftop -F 192.168.1.0/255.255.255.0
</pre>

* -B: 以bytes为单位显示流量(默认是bits)

iftop命令默认显示第一块网卡的流量：
{% highlight string %}
# iftop
interface: eth0
IP address is: 10.17.253.170
MAC address is: 38:ffffff90:ffffffa5:7f:7c:ffffffac
 Press H or ? for help            191Mb                             381Mb                             572Mb                             763Mb                         954Mb
+---------------------------------+---------------------------------+---------------------------------+---------------------------------+----------------------------------
ceph001-05                                                     => ceph001-02                                                      2.54Mb  2.54Mb  2.54Mb
                                                                        <=                                                                          2.10Mb  2.10Mb  2.10Mb
ceph001-05                                                     => ceph001-01                                                      2.94Mb  2.94Mb  2.94Mb
                                                                        <=                                                                          1.55Mb  1.55Mb  1.55Mb
ceph001-05                                                     => ceph001-03                                                      1.55Mb  1.55Mb  1.55Mb
                                                                        <=                                                                          1.79Mb  1.79Mb  1.79Mb
ceph001-05                                                     => ceph001-07                                                      1.47Mb  1.47Mb  1.47Mb
                                                                        <=                                                                          1.68Mb  1.68Mb  1.68Mb
ceph001-05                                                     => ceph001-09                                                      1.19Mb  1.19Mb  1.19Mb
                                                                        <=                                                                          1.40Mb  1.40Mb  1.40Mb
ceph001-05                                                     => ceph001-08                                                       966Kb   966Kb   966Kb
                                                                        <=                                                                           981Kb   981Kb   981Kb
ceph001-05                                                     => ceph001-06                                                       272Kb   272Kb   272Kb
                                                                        <=                                                                           271Kb   271Kb   271Kb
ceph001-05                                                     => 10.17.154.52                                                              465Kb   465Kb   465Kb
                                                                        <=                                                                          4.17Kb  4.17Kb  4.17Kb
ceph001-05                                                     => 172.28.160.243                                                            442Kb   442Kb   442Kb
                                                                        <=                                                                          12.4Kb  12.4Kb  12.4Kb
ceph001-05                                                     => ceph001-04                                                       176Kb   176Kb   176Kb
                                                                        <=                                                                           181Kb   181Kb   181Kb
ceph001-05                                                     => 10.17.144.211                                                            11.7Kb  11.7Kb  11.7Kb
                                                                        <=                                                                           112Kb   112Kb   112Kb
ceph001-05                                                     => 10.17.144.197                                                            3.31Kb  3.31Kb  3.31Kb
                                                                        <=                                                                          6.77Kb  6.77Kb  6.77Kb
ceph001-05                                                     => 10.16.11.106                                                             3.64Kb  3.64Kb  3.64Kb
                                                                        <=                                                                          6.41Kb  6.41Kb  6.41Kb
ceph001-05                                                     => 10.17.144.217                                                            4.70Kb  4.70Kb  4.70Kb
                                                                        <=                                                                          3.48Kb  3.48Kb  3.48Kb
ceph001-05                                                     => 10.133.146.47                                                            5.22Kb  5.22Kb  5.22Kb
                                                                        <=                                                                          2.23Kb  2.23Kb  2.23Kb
ceph001-05                                                     => 10.17.147.26                                                             3.72Kb  3.72Kb  3.72Kb
                                                                        <=                                                                          2.53Kb  2.53Kb  2.53Kb
ceph001-05                                                     => 10.17.147.29                                                             3.49Kb  3.49Kb  3.49Kb
                                                                        <=                                                                          2.09Kb  2.09Kb  2.09Kb
ceph001-05                                                     => 10.17.152.88                                                              416b    416b    416b
                                                                        <=                                                                           416b    416b    416b
ceph001-05                                                     => 172.28.160.241                                                            208b    208b    208b
                                                                        <=                                                                           368b    368b    368b
ceph001-05                                                     => 10.58.8.126                                                               160b    160b    160b
                                                                        <=                                                                           320b    320b    320b

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
TX:             cum:   4.27MB   peak:   12.0Mb                                                                                             rates:   12.0Mb  12.0Mb  12.0Mb
RX:                    3.80MB           10.1Mb                                                                                                      10.1Mb  10.1Mb  10.1Mb
Total:                 59.4MB           38.9Mb                                                                                                      34.1Mb  33.8Mb  34.0Mb
{% endhighlight %}

下面简要介绍一下上面打印信息的含义。iftop的输出从整体上可以分为三大部分：

* 第一部分是iftop输出中最上面的一行，此行是流量刻度，用于显示网卡带宽流量

* 第二部分是iftop输出中最大的一个部分，此部分又分为左中右三列，左列和中列记录了哪些IP或主机正在与本机的网络进行连接。其中中列的```=>```代表发送数据，而```<=```代表接收数据，通过这个指示箭头可以很清晰的知道两个IP之间的通信情况。最右列又分为三个小列，这些实时参数分别表示外部IP连接到本机2s、10s和40s的平均流量。另外这个部分还有一个流量图形条，流量图形条是对流量大小的动态展示，以第一部分中的流量刻度为基准。通过这个流量图形条可以很方便的看出哪个IP的流量最大，从而迅速定位网络中可能出现的流量问题。

* 第三部分位于iftop输出的最下面，可以分为三行，其中```TX```表示发送的数据，```RX```表示接收的数据，```TOTAL```表示发送和接收的全部流量。与这三行对应的有三列，其中```cum列```表示从运行iftop到目前的发送、接收和总数据流量； ```peak列```表示发送、接收以及总的流量峰值； ```rates列```表示过去2s、10s和40s的平均流量值；




## 3. Linux性能监控工具sysstat

sysstat提供了Linux性能监控的工具集，包括： sar、sadf、mpstat、iostat、pidstat等，这些工具可以监控系统性能和实用情况。各工具的作用如下：

* iostat: 用于监控系统的IO设备的平均负载；对于CPU的负载，一般只能查看所有CPU的平均信息

* mpstat: 提供单个或组合CPU相关统计

* pidstat: 提供Linux进程级别统计（IO、CPU、内存等）

* sar： 收集、报告、保存系统活动信息（CPU、内存、磁盘、中断、网络接口、TTY、内核表等）

* sadc: 系统活动数据收集器、作为sar后端使用

* sa1: 收集系统活动日常数据，并以二进制格式存储，它作为sadc工具的前端，可以通过cron来调用

* sa2: 生成系统每日活动报告，同样作为```sadc```工具的前端，可以通过cron来调用

* sadf: 可以CSV、XML等格式显示```sar```收集的性能数据，这样可非常方便的将系统数据导入到数据库，或导入Excel中来生成图表

* nfsiostat: sysstat工具集中提供的NFS IO统计

* cifsiostat: 提供CIFS统计

sysstat功能强大并且在不断增强，每个版本提供了一些不同的功能，用户可以到[sysstat官网](http://sebastien.godard.pagesperso-orange.fr/)了解工具最新发展状况和获得相应的帮助手册。




### 3.1 sysstat工具集的安装

通常情况下，我们在Centos操作系统上可以直接通过如下的命令进行安装：
<pre>
# yum install sysstat
</pre>
我们也可以在官网下载源代码来进行安装：
<pre>
# wget http://pagesperso-orange.fr/sebastien.godard/sysstat-11.0.5.tar.xz
# xz -d sysstat-11.05.tar.xz
# tar -xvf sysstat-11.05.tar
# cd sysstat-11.05/
# ./configure
# make
# make install
</pre>


### 3.2 mpstate命令
mpstat是multi-processor statistics的缩写，它能实时监测多处理器系统上每个CPU的实用情况。mpstat命令的典型用法是：
<pre>
# mpstat [ -A ] [ -u ] [ -V ] [ -I { SUM | CPU | SCPU | ALL } ] [ -P { cpu [,...] | ON | ALL } ] [ interval [ count ] ]
</pre>
选项```P```指定要监控的CPU号(范围是[0,CPU_cnt-1])，其中值```ALL```表示监测所有的CPU。```interval```参数是采样间隔（单位是:秒)，即每隔interval的时间输出一次统计信息。```count```参数是采样次数，即共输出count次统计信息，但最后还会输出这count次采样结果的平均值。与```vmstat```命令一样，mpstat命令输出的第一次结果是自系统启动以来的平均结果，而后面(count-1)次输出结果则是采样间隔内的平均结果。例如：
<pre>
//命令每隔5s输出一次结果，功输出2次
# mpstat -P ALL 5 2
Linux 3.10.0-327.el7.x86_64 (ceph001-node1)     01/11/2019      _x86_64_        (40 CPU)

07:17:34 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
07:17:39 PM  all    0.09    0.00    0.15    0.00    0.00    0.03    0.00    0.00    0.00   99.74
07:17:39 PM    0    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM    1    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:39 PM    2    0.20    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.40
07:17:39 PM    3    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM    4    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:39 PM    5    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM    6    0.20    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.40
07:17:39 PM    7    0.20    0.00    0.40    0.00    0.00    0.00    0.00    0.00    0.00   99.40
07:17:39 PM    8    0.40    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.40
07:17:39 PM    9    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   10    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   11    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   12    0.00    0.00    0.00    0.00    0.00    0.20    0.00    0.00    0.00   99.80
07:17:39 PM   13    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   14    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:39 PM   15    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   16    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   17    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   18    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:39 PM   19    0.00    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.60
07:17:39 PM   20    0.00    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.60
07:17:39 PM   21    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   22    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   23    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   24    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   25    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:39 PM   26    0.20    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.40
07:17:39 PM   27    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:39 PM   28    0.00    0.00    0.20    0.00    0.00    0.20    0.00    0.00    0.00   99.60
07:17:39 PM   29    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   30    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:39 PM   31    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   32    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   33    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:39 PM   34    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:39 PM   35    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   36    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   37    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:39 PM   38    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:39 PM   39    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80

07:17:39 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
07:17:44 PM  all    0.07    0.00    0.10    0.00    0.00    0.02    0.00    0.00    0.00   99.81
07:17:44 PM    0    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM    1    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM    2    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM    3    0.20    0.00    0.00    0.00    0.00    0.20    0.00    0.00    0.00   99.60
07:17:44 PM    4    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM    5    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM    6    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM    7    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM    8    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM    9    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM   10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   11    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   12    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   13    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   14    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   15    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   16    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   17    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   18    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   19    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   20    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   21    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   22    0.40    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM   23    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   24    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   25    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   26    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   27    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
07:17:44 PM   28    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   29    0.20    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   30    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   31    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
07:17:44 PM   32    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   33    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   34    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   35    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   36    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   37    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   38    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
07:17:44 PM   39    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00

Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
Average:     all    0.08    0.00    0.12    0.00    0.00    0.02    0.00    0.00    0.00   99.78
Average:       0    0.10    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:       1    0.10    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:       2    0.20    0.00    0.20    0.00    0.00    0.10    0.00    0.00    0.00   99.50
Average:       3    0.10    0.00    0.10    0.00    0.00    0.10    0.00    0.00    0.00   99.70
Average:       4    0.20    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.60
Average:       5    0.20    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:       6    0.20    0.00    0.10    0.00    0.00    0.10    0.00    0.00    0.00   99.60
Average:       7    0.10    0.00    0.30    0.00    0.00    0.00    0.00    0.00    0.00   99.60
Average:       8    0.30    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.50
Average:       9    0.10    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:      10    0.10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      11    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      12    0.00    0.00    0.10    0.00    0.00    0.10    0.00    0.00    0.00   99.80
Average:      13    0.00    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      14    0.10    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:      15    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      16    0.00    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      17    0.00    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      18    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      19    0.00    0.00    0.20    0.00    0.00    0.10    0.00    0.00    0.00   99.70
Average:      20    0.00    0.00    0.20    0.00    0.00    0.10    0.00    0.00    0.00   99.70
Average:      21    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      22    0.20    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:      23    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      24    0.00    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      25    0.10    0.00    0.20    0.00    0.00    0.00    0.00    0.00    0.00   99.70
Average:      26    0.10    0.00    0.20    0.00    0.00    0.10    0.00    0.00    0.00   99.60
Average:      27    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      28    0.00    0.00    0.10    0.00    0.00    0.10    0.00    0.00    0.00   99.80
Average:      29    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      30    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
Average:      31    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      32    0.10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      33    0.10    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.80
Average:      34    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
Average:      35    0.10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      36    0.10    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      37    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00    0.00  100.00
Average:      38    0.00    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.90
Average:      39    0.00    0.00    0.10    0.00    0.00    0.00    0.00    0.00    0.00   99.90
</pre>

上面每条信息都包含如下几个字段：

* CPU: 指示该条信息是哪个CPU的数据。```0```表示是第一个CPU的数据，```1```表示是第二个CPU的数据，```all```则表示所有CPU数据的平均值

* %usr: 除了nice值为负的进程，系统上其他进程运行在用户空间的时间占CPU总运行时间的比例

* %nice: nice值为负的进程运行在用户空间的时间占CPU总运行时间的比例

* %sys: 系统上所有进程运行在内核空间的时间占CPU总运行时间的比例，但不包括硬件和软件中断消耗的CPU时间

* %iowait: CPU等待磁盘操作的时间栈CPU总运行时间的比例

* %irq: CPU用于处理硬件中断的时间占CPU总运行时间的比例

* %soft: CPU用于处理软件中断的时间占CPU总运行时间的比例

* %steal: 一个物理CPU可以包含一对虚拟CPU，这一对虚拟CPU由超级管理程序管理。当超级管理程序在处理某个虚拟CPU时，另一个虚拟CPU则必须等待它处理完成才能运行。这部分时间就是所谓的steal时间。该字段表示steal时间占CPU总运行时间的比例

* %guest: 运行虚拟CPU的时间占CPU总运行时间的比例

* %idle： 系统空闲的时间占CPU总运行时间的比例

在所有这些输出字段中，我们最关心的是```%usr```、```%sys```以及```%idle```。它们基本上反映了我们的代码中业务逻辑代码和系统调用所占的比例，以及系统还能承受多大的负载。很显然，在上面的输出中，执行系统调用占用CPU的时间，以及用户业务逻辑调用占用的CPU时间都是极低的。




<br />
<br />

**[参看]:**

1. [详解mpstat、iostat、sar、vmstat命令的使用](https://blog.csdn.net/qq_39591494/article/details/78418162)

2. [Linux性能监控工具sysstat系列：介绍与安装](https://blog.csdn.net/jinguangliu/article/details/47205347)

3. [Linux系统工具sar查看内存、CPU、IO](https://blog.csdn.net/ydyang1126/article/details/52794235)

4. [查看CPU性能参数（mpstat, iostat, sar、vmstat）等命令详解](https://blog.csdn.net/kangshuo2471781030/article/details/79319089)

5. [sysstat官网](http://sebastien.godard.pagesperso-orange.fr/)

<br />
<br />
<br />


