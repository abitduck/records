---
layout: post
title: git工具的使用
tags:
- tools
categories: tools
description: git工具的使用
---

本文主要介绍一下git工具的使用。为了使后面的学习更顺利，记住下面这些关于Git的概念。Git有三种状态，你的文件可能处于其中之一： 


* 已修改(mofified)

* 已暂存(staged)

* 已提交(committed)

<!-- more -->

已修改（modified)表示修改了文件，但还没保存到数据库中； 已暂存(staged)表示对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中； 已提交(committed)表示数据已经安全的保存在本地数据库中。

由此，引入Git项目的三个工作区的概念： Git仓库、工作目录、暂存区，如下图所示：

![git-workspace](https://ivanzz1001.github.io/records/assets/img/tools/git-workspace.png)

```Git仓库目录```是Git用来保存项目的元数据和对象数据库的地方。这是Git中最重要的部分，从其他计算机克隆仓库时，拷贝的就是这里的数据。

工作目录是对项目的某个版本独立提取出来的内容。这些从Git仓库的压缩数据库中提出出来的文件，放在磁盘上供你使用或修改。

暂存区域是一个文件，保存了下次将提交的文件列表信息，一般在Git仓库目录中。有时候也被称作“索引”，不过一般说法还是叫暂存区域。

基本的Git工作流程如下：
<pre>
1) 在工作目录中修改文件

2) 暂存文件，将文件的快照放入暂存区域

3) 提交更新，找到暂存区域的文件，将快照永久性存储到Git仓库目录
</pre>
如果Git目录中保存着的特定版本文件，就属于已提交状态；如果作了修改并已放入暂存区域，就属于已暂存状态；如果自上次取出后，作了修改但还没有放到暂存区域，就是已修改状态。在后续，你会进一步了解这些状态的细节，并学会如何根据文件状态实施后续操作，以及怎样跳过暂存直接提交。

## 1. Git的安装设置

### 1.1 Windows下Git工具的安装
1） 到[git官方网站](https://git-scm.com/downloads)去下载合适版本的git客户端，然后基本按默认方式安装即可。

2) TortoiseGit是给git安装一个外壳，以使git工具的使用更加方便。可以到[TortoiseGit官方网站](https://tortoisegit.org/download/)下载相应的安装包安装即可。

### 1.2 Linux下Git工具的安装
在Centos7环境下， 我们可以执行如下命令直接安装Git：
{% highlight string %}
# yum install git
# git --version
git version 1.8.3.1

# git --help
usage: git [--version] [--help] [-c name=value]
           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]
           [-p|--paginate|--no-pager] [--no-replace-objects] [--bare]
           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]
           <command> [<args>]

The most commonly used git commands are:
   add        Add file contents to the index
   bisect     Find by binary search the change that introduced a bug
   branch     List, create, or delete branches
   checkout   Checkout a branch or paths to the working tree
   clone      Clone a repository into a new directory
   commit     Record changes to the repository
   diff       Show changes between commits, commit and working tree, etc
   fetch      Download objects and refs from another repository
   grep       Print lines matching a pattern
   init       Create an empty Git repository or reinitialize an existing one
   log        Show commit logs
   merge      Join two or more development histories together
   mv         Move or rename a file, a directory, or a symlink
   pull       Fetch from and merge with another repository or a local branch
   push       Update remote refs along with associated objects
   rebase     Forward-port local commits to the updated upstream head
   reset      Reset current HEAD to the specified state
   rm         Remove files from the working tree and from the index
   show       Show various types of objects
   status     Show the working tree status
   tag        Create, list, delete or verify a tag object signed with GPG
{% endhighlight %}

### 1.3 使用前配置
Git自带一个```git config```的工具来帮助设置控制Git外观和行为的配置变量。这些变量存储在三个不同的位置：
<pre>
1. /etc/gitconfig文件： 包含系统上每一个用户及他们仓库的通用配置。如果使用带有 --system 选项的 git config 时，
   它会从此文件读写配置变量

2. ~/.gitconfig 或 ~/.config/git/config文件： 只针对当前用户。可以传递 --global 选项让Git读写此文件。 

3. 当前使用仓库的Git目录中的config文件(就是.git/config): 针对该仓库
</pre

每一个级别覆盖上一级别的配置，所以```.git/config```的配置变量会覆盖```/etc/gitconfig```中的配置变量。

在Windows系统中， Git会查找```$HOME```目录下（一般情况下是```C:\Users\$USER```)的```.gitconfig```文件。Git同样也会寻找```/etc/gitconfig```文件，但只限于MSys的根目录下，即安装Git时所选的目标位置。

1) **配置用户信息**

当安装完Git应该做的第一件事就是设置```用户名称```与```邮件地址```。这样做很重要，因为每一个Git的提交都会使用这些信息，并且它会写入到每一次提交中，不可更改：
<pre>
# git config --global user.name "ivan1001"
# git config --global user.email "ivan1001@github.com"
# git config --list
user.name=ivan1001
user.email=ivan1001@github.com
</pre>

再次强调，如果使用了```--global```选线，那么该命令只需要运行一次，因为之后无论你在该系统上做任何事情，Git都会使用这些信息。当你想针对特定项目使用不同的用户名称和邮件地址时，可以在那个项目目录下运行```不使用--global```选项的命令来配置。

很对GUI工具都会在第一次运行时帮助你配置这些信息。

如果要删除，可以使用```--unset```选项：
<pre>
# git config --global --unset user.name
</pre>

2) **文本编辑器**

既然用户信息已经设置完毕，你可以配置默认文本编辑器了。当Git需要您输入信息时会调用它。如果未配置，Git会使用操作系统默认的文本编辑器，通常是```vim```。如果你想使用不同的文本编辑器，例如```Emacs```，可以这样做：
<pre>
# git config --global core.editor emacs
</pre>

3) **检查配置信息**

如果想要检查你的配置，可以使用```git config --list```命令来列出所有Git当时能找到的配置：
<pre>
# git config --list
user.name=ivan1001
user.email=ivan1001@github.com
core.repositoryformatversion=0
core.filemode=true
core.bare=false
core.logallrefupdates=true
</rpe>
上面的输出结果中，可能会看到重复的变量名，因为Git会从不同的文件中读取同一个配置（例如： ```/etc/gitconfig```与```~/.gitconfig```)。这种情况下，Git会使用它找到的每一个变量的最后一个配置。

可以通过输入```git config <key>```来检查Git的某一项配置：
<pre>
# git config user.name
ivan1001
</pre>


4) **获取帮助**

若在使用Git时需要获取帮助，有三种方法可以找到Git命令的使用手册：
{% highlight string %}
# git help <verb>

# git <verb> --help

# man git-<verb>
{% endhighlight %}

例如，要想获得```config```命令手册，执行：
<pre>
# git help config
</pre>



## 2. Git的简单使用

**1) 创建一个新的repository**
<pre>
# git clone http://10.16.28.73/harbor/harbor.git
# cd harbor
# touch README.md
# git add README.md
# git commit -m "add README"
# git push -u origin master
</pre>



**2) 从一个已存在的文件夹与某个repository关联**
<pre>
# cd existing_folder
# git init
# git remote add origin http://10.16.28.73/harbor/harbor.git
# git add .
# git commit -m "Initial commit"
# git push -u origin master
</pre>
注： 上述```http://10.16.28.73/harbor/harbor.git```必须事先存在




**3) 将一个已存在repository与另一个repository关联**
<pre>
# cd existing_repo
# git remote add origin http://10.16.28.73/harbor/harbor.git
# git push -u origin --all
# git push -u origin --tags
</pre>


**4）删除一个文件，并提交**
<pre>
# git rm test.txt
# git commit -m "remove test.txt"
# git push -u origin master
</pre>
上面删除一个文件test.txt，并提交。

**5) 修改一个文件并提交**
<pre>
# git add test.txt
# git commit -m "modified test.txt"
# git push -u origin master
</pre>
上面假设修改了test.txt文件，然后提交到github上。这里向github提交修改后的文件的命令与新添加文件一直。

<br />
<br />

**[参看]**

1. [git教程](https://www.yiibai.com/git/getting-started-git-basics.html)

2. [git创建远程仓库并上传代码到远程仓库中](https://blog.csdn.net/liuweixiao520/article/details/78971221)

3. [git book](https://git-scm.com/book/zh/v2)

4. [Git 基础再学习之：git checkout -- file](https://www.cnblogs.com/Calvino/p/5930656.html)

<br />
<br />
<br />

