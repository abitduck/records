---
layout: post
title: 有向无环图及其应用
tags:
- data-structure
categories: data-structure
description: 有向无环图及其应用
---

本章我们介绍一下有向无环图及其相关的应用。

<!-- more -->


## 1. 有向无环图
一个无环的有向图称作```有向无环图```(directed acycline graph)，简称DAG图。DAG图是一类较有向树更一般的特殊有向图，如下图7.21列示了有向树、DAG图和有向图的例子。

![ds-graph-dag](https://ivanzz1001.github.io/records/assets/img/data_structure/ds_graph_dag1.jpg)


有向无环图是描述含有公共子式的表达式的有效工具。例如下述表达式：
<pre>
((a+b) * (b * (c+d)) + (c+d)*e) * ((c+d)*e)
</pre>

可以用第6章讨论的二叉树来表示，如下图7.22所示。仔细观察该表达式，可发现有一些相同的子表达式，如```(c+d)```和```(c+d)*e```等，在二叉树中，它们也重复出现。若利用有向无环图，则可以实现对相同子式的共享，从而节省存储空间。例如下图7.23所示为表示同一表达式的有向无环图。

![ds-graph-dag](https://ivanzz1001.github.io/records/assets/img/data_structure/ds_graph_dag2.jpg)

检查一个有向图是否存在环要比无向图复杂。对于无向图来说，若深度优先遍历过程中遇到回边（即指向已访问过的顶点的边），则必定存在环；而对于有向图来说，这条回边有可能是指向深度优先生成森林中另一棵生成树上顶点的弧。但是，如果从有向图上某个顶点v出发出发的遍历，在dfs(v)结束之前出现一条从```顶点u```到```顶点v```的回边（如图7.24所示），由于u在生成树上是v的子孙，则有向图中必定存在包含顶点v和u的环。

![ds-graph-dag](https://ivanzz1001.github.io/records/assets/img/data_structure/ds_graph_dag3.jpg)

有向无环图也是描述一项工程或系统的进行过程的有效工具。除最简单的情况之外，几乎所有的工程(project)都可分为若干个称作```活动```(activity)的子工程，而这些子工程之间，通常受着一定条件的约束，如其中某些子工程的开始必须在另一些子工程完成之后。对整个工程和系统，人们关心的是两个方面的问题： 一是工程能否顺利进行；二是估算整个工程完成所必须的最短时间，对应于有向图，即为进行拓扑排序和求关键路径的操作。下面分别就这两个问题讨论之。

### 1.1 拓扑排序
什么是```拓扑排序```(Topological Sort)?简单地说，由某个集合上的一个偏序得到该集合上的一个全序，这个操作称之为拓扑排序。回顾离散数学中关于偏序和全序的定义：
<pre>
若集合X上的关系R是自反的、反对称的和传递的，则称R是集合X上的偏序关系。
</pre>
直观地看，偏序指集合中仅有部分成员之间可比较，而全序指集合中全体成员之间均可比较。例如，下图7.25所示的两个有向图，图中弧<x,y> 表示```x<=y```，则(a)表示偏序，(b)表示全序。若在(a)的有向图上人为地加一个表示```v2<=v3```的弧(符号```<=```表示v2领先于v3)，则(a)表示的亦为全序，且这个全序称为```拓扑有序```(Topological Order)，而由偏序定义得到的拓扑有序的操作便是拓扑排序。


一个表示偏序的有向图可用来表示一个流程图。它或者是一个施工流程图，或者是一个产品生产的流程图，再或者是一个数据流图（每个顶点表示一个过程）。图中每一条有向边表示两个子工程之间的次序关系（领先关系）。

例如，一个软件专业的学生必须学习一系列基本课程（如下图7.26所示），

![ds-graph-topsort](https://ivanzz1001.github.io/records/assets/img/data_structure/ds_graph_topsort1.jpg)

其中有些课程是基础课，它独立于其他课程，如《高等数学》；而另一些课程必须在学完作为它的基础的先修课程才能开始。如，在《程序设计基础》和《离散数学》学完之前就不能开始学习《数据结构》。这些先决条件定义了课程之间的领先（优先）关系。这个关系可以用有向图更清楚地表示，如图7.27所示。图中顶点表示课程，有向边（弧）表示先决条件。若```课程i```是```课程j```的先决条件，则图中有弧<i,j>。

![ds-graph-course](https://ivanzz1001.github.io/records/assets/img/data_structure/ds_graph_course.jpg)

这种用顶点表示活动，用弧表示活动间的优先关系的有向图称为```顶点表示活动的网```(Activity On Vertex Network)，简称AOV-网。在网中，若从```顶点i```到```顶点j```有一条有向路径，则i是j的前驱；j是i的后继。若<i,j>是网中的一条弧，则i是j的直接前驱；j是i的直接后继。


在AOV-网中，不应该出现有向环，因为存在环意味着某项活动应以自己为先决条件。显然，这是荒谬的。若设计出这样的流程图，工程便无法进行。而对程序的流程图来说，则表明存在一个死循环。因此，对给定的AOV-网应首先判定网中是否存在环。检测的办法是对有向图构造其顶点的拓扑有序序列，若网中所有顶点都在它的拓扑有序序列中，在该AOV-网中必定不存在环。例如，图7.27的有向图有如下两个拓扑有序序列：
<pre>
(C1, C2, C3, C4, C5, C7, C9, C10, C11, C6, C12, C8)
和
(C9, C10, C11, C6, C1, C12, C4, C2, C3, C5, C7, C8)
</pre>
(当然，对此图也可构造得其他的拓扑有序序列）。若某个学生每学期只学一门课程的话，则他必须按拓扑有序的顺序来安排学习计划。

如何进行拓扑排序？解决的方法很简单：


### 1.2 关键路径


<br />
<br />

**[参看]:**

1. [data-structure](https://www.geeksforgeeks.org/detect-cycle-in-a-graph/)